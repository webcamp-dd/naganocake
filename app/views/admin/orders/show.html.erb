<h1>注文履歴詳細</h1>

<table>
	<thead>
		<tr></tr>
	</thead>
	<tbody>
		<tr>
			<td>購入者</td>
			<td><%= @order.name %></td>
		</tr>
		<tr>
			<td>配送先</td>
			<td><%= @order.postal_code + @order.address + @order.name %></td>
		</tr>
		<tr>
			<td>支払方法</td>
			<td><%= @order.payment %></td>
		</tr>
		<tr>
			<td>注文ステータス</td>
			<td>
				<%= form_with model: @order , url:admin_order_path(@order) do |f| %>
				<%= f.select :status, [["入金待ち","0"],["入金確認","1"],["製作中","2"],["発送準備中","3"],["発送済み","4"]] %>
				<%= f.submit "更新",class: "btn btn-primary" %>
				<% end %>
			</td>
		</tr>
	</tbody>
</table>

<table class="table table-hover">
	<thead>
		<tr>
			<th>商品名</th>
			<th>単価（税込）</th>
			<th>数量</th>
			<th>小計</th>
			<th>製作ステータス</th>
			<th></th>
		</tr>
	</thead>
	<tbody>
		<% @order_product.each do |g| %>
		<tr>
			<td><%= g.product.name %></td>
			<td><%= ((g.purchase_unit_price * 1.1).round).to_s(:delimited) %></td>
			<td><%= g.quantity %></td>
			<td><%= ((g.purchase_unit_price * g.quantity * 1.1).round).to_s(:delimited) %></td>

			<%= form_with model: @order_product , url:admin_order_path(g) do |h| %>
			<td>
				<%= h.select :status, [["着手不可","0"],["製作待ち","1"],["製作中","2"],["製作完了","3"]] %>
			</td>
			<td><%= h.submit "更新",class: "btn btn-primary" %></td>
			<% end %>
		</tr>
		<% end %>
	</tbody>
</table>

<div>
	<p>商品合計</p>
	<%=@order.total_price.to_s(:delimited) %>
	<p>送料</p>
	<%=@order.postage.to_s(:delimited) %>
	<p>請求金額合計</p>
	<%= (@order.total_price + @order.postage).to_s(:delimited) %>
</div>