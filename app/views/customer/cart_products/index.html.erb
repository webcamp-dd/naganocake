
<div class="container">
    <div class="row">  
        <div class="col-xs-10">
        <%#ステップバー  %>
        <%= render 'customer/cart_products/step_bar1'%>
            <div class="title"><h3>ショッピングカート</h3><div>
            <%= notice %>
             <div class= "right_bottom">
                    <%= link_to "カートを空にする", customer_path(current_customer), method: :delete, data: {confirm: "カート内商品を全て削除してもよろしいですか？"}, class: "btn-right btn-sm btn-danger" %>
             </div>
                 <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th class="warning">商品名</th>
                            <th class="warning">単価(税込)</th>
                            <th class="warning">数量</th>
                            <th class="warning">小計</th>
                            <th class="warning"></th>
                        </tr>
                    </thead>
                    <% sum = 0 %>
                    <% @cart_products.each do |cart_product| %>
                        <tbody>
                            <tr class="active">
                                <td>
                                <%= attachment_image_tag @product, :product_image, :fill, 100, 100, format: 'jpeg', fallback: "no-image-mini.jpg" %>
                                <%= cart_product.product.name %>
                                </td>
                                <td><%= cart_product.product.unit_price %></td>
                                <td>
                                    <%= form_with model: cart_product, local: true,url: customer_cart_product_path(cart_product), method: :patch do |f| %>
                                        <%= f.number_field :quantity, selected: cart_product.quantity.to_i %>
                                        <%= f.submit "変更",class:"btn-warning" %>
                                    <% end %>
                                </td>
                                <td>
                                <% cart_product.product.unit_price %>
                                <% sumone = cart_product.quantity.to_i * cart_product.product.unit_price.to_i %>
                                <%= sumone.to_s(:delimited) %></td>
                                <td>
                                    <%= link_to "削除する", customer_cart_product_path(cart_product), method: :delete, data: {confirm: "本当に削除してもよろしいですか？"}, class: "btn-sm btn-danger" %>
                                </td>
                            </tr>
                        </tbody>
                        <% sum += sumone %>
                    <% end %>
                </table>

    <div class="row">  
    <div class="col-xs-10">
        <div class="bottom">
                <%= link_to "買い物を続ける", customer_products_index_path, class: "shop-btn btn-sm btn-primary" %>
        </div>
    </div>
     <div class="row">      
     <div class="col-xs-2">    

                    <table class="table table-bordered">
                            <tr class="active">
                                <th class="warning">合計金額</th>
                                <td><%= sum.to_s(:delimited) %></td>
                        </tr>
                    </table>
                </div>
    </div>
    </div>
    <div class="row">  
     <div class="col-xs-10">
                <div class="next-btn text-center">
                <%= link_to "情報入力に進む", new_customer_order_path, class:" btn btn-warning btn-lg" %>   
                </div>
    </div>
    </div>
    
                <%# 以降レイアウト用 %>
        </div>
    <div>
</div>
